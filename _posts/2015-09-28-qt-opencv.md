---
layout: post
title:  Qt中使用Opencv
date:   2015-09-28 
categories: Devel
tags: Devel
---

### QT-OpenCV-参考
[http://www.mamicode.com/info-detail-500574.html](http://www.mamicode.com/info-detail-500574.html)  
[http://blog.csdn.net/superdont/article/details/26007717](http://blog.csdn.net/superdont/article/details/26007717)  
编译 [http://www.cnblogs.com/liu-jun/archive/2012/09/26/Jacky_Liu.html](http://www.cnblogs.com/liu-jun/archive/2012/09/26/Jacky_Liu.html)  
出错[http://answers.opencv.org/question/40159/cannot-compile-opencv-30/](http://answers.opencv.org/question/40159/cannot-compile-opencv-30/)

### 编译Opencv
最近两天在安装opencv，因为不熟悉VC，所以打算用QT+opencv。网上找了一些资料，主要是上述第一二两个链接。按照链接里的说明操作，注意一点，帖子里不仔细看没有主要到，就是要对opencv的源代码中，编译参数做一个修改，去掉一个报错警告。我头几次尝试都编译不通，又下载别的opencv版本，还是有问题，最后仔细看是没注意到对编译选项的修改说明。
编译完成后，将include，lib，bin打包拷贝到固定的目录下，再设置好PATH，然后在QT工程中，只需要添加：

    INCLUDEPATH += C:/opencv/3.0/3.0/include/opencv2 \
                   C:/opencv/3.0/3.0/include/opencv \
                   C:/opencv/3.0/3.0/include
    LIBS += C:/opencv/3.0/3.0/lib/libopencv_*.a 

就可以使用opencv了。但是我在这个过程中，一直碰到一个问题，就是编译正常，但是运行不起来。程序直接退出并提示  
```  
exited with code -1073741515
```  
后来百度，这个问题，说这个错误代码都是运行时找不到库，反复确认了设置的参数，又换了opencv版本重新试验。还是不行，最后发现，在命令行下面是可以执行的，就是在QT里run就会退出报错。然后发现QT里，project设置的source跟debug编译路径不在一起，在两个盘，把debug路径修改到source旁边，再编译运行，发现在QT里也可以直接run了。不知道是为啥，反正它现在能run了。

### 一个测试用例

```cpp
//#include "mainwindow.h"
#include "dialog1.h"
#include <QApplication>
#include <QLabel>
#include <QPushButton>
#include <QVBoxLayout>
#include <QDialog>
#include <QLineEdit>
#include <QString>
//#include <QtGui>
#include <ledialog.h>
#include <ledrawlabel.h>
#include <iconeditor.h>
#include <QMessageBox>
#include <leimgregion.h>
//#include"cv.h"
//#include"cxcore.h"
//#include"highgui.h"
#include <opencv2/core/core.hpp>
#include <opencv2/imgproc/imgproc.hpp>
#include <opencv2/highgui/highgui.hpp>
using namespace cv;
int main(int argc, char *argv[])
{
   QApplication a(argc, argv);
//    leimgregion *lir = new leimgregion();
 //   lir->show();   //声明IplImage指针
    /*
  IplImage*pImg;
    //载入图片
    pImg=cvLoadImage("D:/qtwork/work/jietu1.bmp",1);
    //创建窗口
    cvNamedWindow("Image",1);
    //显示图像
    cvShowImage("Image",pImg);
    //等待按键
    cvWaitKey(0);
    //销毁窗口
    cvDestroyWindow("Image");
    //释放图像
    cvReleaseImage(&pImg);
*/
   LeDialog *dialog1 = new LeDialog();
   dialog1->show();
       Mat ssimg;
    ssimg =imread("D:/qtwork/work/jietu1.bmp");
    imshow("li",ssimg);
    waitKey();
//    return 0;
    return a.exec();
}
```
